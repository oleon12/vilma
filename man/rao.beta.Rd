% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rao.beta.R
\name{rao.beta}
\alias{rao.beta}
\title{Rao Beta (phylogenetic) dissimilarity index}
\usage{
rao.beta(tree, dist, abundance = FALSE, scale01 = TRUE)
}
\arguments{
\item{tree}{A rooted phylogenetic tree of class \code{phylo} with branch lengths.}

\item{dist}{An object of class \code{vilma.dist} (e.g., from \code{points.to.raster()}),
containing at least columns \code{Cell} and \code{Sp} in \code{$distribution}, and a
raster \code{$grid} for mapping outputs.}

\item{abundance}{Logical. If \code{FALSE} (default), the Cell×Sp table is binarized
(presence–absence) before proportions are computed. If \code{TRUE}, raw Cell×Sp
counts from \code{table(Cell, Sp)} define relative abundances.}

\item{scale01}{Logical. If \code{TRUE} (default), \eqn{D} is divided by its maximum
off-diagonal so \eqn{D \in [0,1]} (diagonal set to 0). Under this scaling, Rao β
lies in \eqn{[0,1]} up to numerical tolerance.}
}
\value{
An object of class \code{vilma.beta}:
\itemize{
\item \code{distribution} – Original \code{dist$distribution}.
\item \code{Rao.Beta} – Pairwise Rao β dissimilarity as a \code{stats::dist} object.
\item \code{rasters} – List with:
\code{mean.dissimilarity}, \code{pcoa.1}, \code{pcoa.2},
\code{ndms.1}, \code{ndms.2}.
\item \code{pcoa.eig} – Relative corrected eigenvalues for axes 1–2.
\item \code{ndms.stress} – NDMS stress value.
\item \code{calculation.method} – Summary string of \code{abundance} and \code{scale01}.
\item \code{algorithm} – The string \code{"RaoBeta"}.
}
}
\description{
Computes \strong{between-community} phylogenetic dissimilarity (Rao β) among spatial
cells using a rooted phylogeny and a \code{vilma.dist} object. Rao β is the
expected phylogenetic dissimilarity between two individuals drawn from
different communities:
\deqn{\Delta_{\mathrm{Rao}}(i,j) = -\tfrac{1}{2}\left(Q_i + Q_j - 2\,p_i^\top D\,p_j\right),}
where \eqn{Q = p^\top D p} is Rao’s α within a community, \eqn{p} are within-cell
relative abundances (presence–absence if \code{abundance = FALSE}), and
\eqn{D} is the patristic distance matrix among species.
}
\details{
Species are intersected between \code{tree$tip.label} and \code{dist$distribution$Sp};
only the common set is used. To ensure correct behavior under taxa-label null
models, the patristic matrix \eqn{D} is \strong{reindexed to match} the community
matrix column order before matrix multiplications. Empty cells (no species after
optional binarization) have their corresponding rows/columns of the output
dissimilarity set to \code{NA}.

In addition to the full pairwise Rao β matrix, the function returns:
\itemize{
\item the mean Rao β per cell (raster),
\item a PCoA of the dissimilarity (first two axes rasterized; Cailliez correction),
\item a 2D NDMS (first two axes rasterized) and the stress value.
}
}
\section{Interpretation}{

With \code{scale01 = TRUE}, Rao β ranges from \code{0} (identical phylogenetic
composition) to \code{1} (maximal turnover). A similarity matrix can be obtained
as \code{1 - as.matrix(Rao.Beta)} if needed.
}

\examples{
\dontrun{
tree <- examplae_tree()
dist <- example_dist()
dist <- points_to_raster(dist)
out <- rao.beta(tree = tree, dist = dist, abundance = FALSE, scale01 = TRUE)
print(out)
plot(out)
view.vilma(out)
}

}
\references{
Rao, C. R. (1982). Diversity and dissimilarity coefficients: a unified approach.
\emph{Theoretical Population Biology}, 21, 24–43. \cr
Botta-Dukát, Z. (2005). Rao’s quadratic entropy as a measure of functional diversity.
\emph{Community Ecology}, 6, 283–290.
}
\seealso{
\code{\link{rao.calc}} (Rao α), \code{\link{rao.calc.null}} (null models),
\code{\link{points_to_raster}}
}
\author{
Omar Daniel Leon-Alvarado \url{https://leon-alvarado.weebly.com/}
J. Angel Soto-Centeno \url{https://www.mormoops.com}
}
