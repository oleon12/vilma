% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/descendant.matrix.R
\name{descendant.matrix}
\alias{descendant.matrix}
\title{Build Descendant Matrix (edges × tips) for a Phylogenetic Tree}
\usage{
descendant.matrix(tree)
}
\arguments{
\item{tree}{A rooted phylogenetic tree of class \code{phylo}.
Branch lengths are not required for this function.}
}
\value{
An integer matrix with:
\itemize{
\item \strong{Rows} corresponding to edges (\code{nrow(tree$edge)}), in the
same order as \code{tree$edge}. Row names are \code{"parent-child"}
node IDs (e.g., \code{"14-15"}).
\item \strong{Columns} corresponding to tips (\code{tree$tip.label}).
\item \strong{Entries} \code{D[e, t] = 1} if tip \code{t} descends from the
child node of edge \code{e}; otherwise \code{0}.
}

Properties:
\itemize{
\item Terminal (tip) edges have exactly one \code{1}.
\item Internal edges have as many \code{1}s as there are tips in the clade
subtended by that edge.
\item The output is deterministic and does not depend on edge reordering.
}
}
\description{
Construct a binary matrix \code{D} indicating which tips (species) descend
from the \emph{child node} of each edge in a rooted phylogenetic tree.
This representation is useful for edge-based metrics (e.g., UniFrac) and
lineage-weighted beta-diversity decompositions.
}
\details{
The algorithm computes, for every node, the set of descendant tips by
aggregating children → parent (a tips-to-root traversal). For each edge,
the descendant set of its child node defines which tip columns receive 1s.
}
\note{
The tree must be \emph{rooted}. If your tree is unrooted, root it
(e.g., with \code{ape::root()}) before calling this function.

#' @author
Omar Daniel Leon-Alvarado \url{https://leon-alvarado.weebly.com/}
J. Angel Soto-Centeno \url{https://www.mormoops.com/}
}
\examples{
\dontrun{
library(ape)

tree <- data(Tree)

D <- descendant.matrix(tre)
dim(D)             # n_edge × n_tip
colnames(D)        # should match tr$tip.label
table(rowSums(D))  # 1 for terminals; >1 for internal edges
}


}
\seealso{
\code{ape::is.rooted}, \code{ape::root}, \code{ape::read.tree}

\code{ape::is.rooted}, \code{ape::root}, \code{ape::read.tree}
}
