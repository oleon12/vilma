% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/faith.pd.R
\name{faith.pd}
\alias{faith.pd}
\title{Faith's Phylogenetic Diversity (PD)}
\usage{
faith.pd(tree, dist, method = c("root", "node", "exclude"))
}
\arguments{
\item{tree}{A rooted phylogenetic tree of class \code{phylo} with branch lengths.}

\item{dist}{An object of class \code{vilma.dist}, typically produced by
\code{points.to.raster()}, containing the species distribution data.}

\item{method}{Character string specifying how to handle single-species cells.
Options are:
\itemize{
\item \code{"root"} – For cells with single species, PD is calculated considering the root path to the species.
\item \code{"node"} – For cells with single species, PD considers the closest ancestral node length.
\item \code{"exclude"} – Single-species cells are excluded from the calculation (default).
}}
}
\value{
An object of class \code{vilma.pd}, which is a list containing:
\itemize{
\item \code{distribution} – Original species distribution.
\item \code{grid} – The reference raster grid.
\item \code{pd.table} – Data frame with cells, species richness, and PD values.
\item \code{rasters} – List with abundance, richness, and PD rasters.
\item \code{calculation.method} – Method used for single-species cells.
\item \code{index} – The string \code{"faith.pd"}.
}
}
\description{
Calculates Faith’s Phylogenetic Diversity (PD) for species assemblages across spatial cells
using a rooted phylogenetic tree and species distributions.
The function supports different treatments of single-species cells through the
\code{method} argument.
}
\details{
Faith’s PD is calculated as the sum of the branch lengths of the minimum spanning
path connecting all species in a cell. Species not shared between \code{tree} and
\code{dist} are ignored, and informative messages are returned about missing species.
}
\examples{
\dontrun{
tree <- examplae_tree()
dist <- example_dist()
dist <- points_to_raster(dist)

# Calculate PD excluding single-species cells
fpd <- faith.pd(tree = tree, dist = dist, method = "exclude")

print(fpd)
plot(fpd)
view.vilma(fpd)
}
}
\references{
Faith, D.P. (1992). Conservation evaluation and phylogenetic diversity.
\emph{Biological Conservation}, 61(1), 1–10.
\doi{10.1016/0006-3207(92)91201-3}

Webb, C.O., Ackerly, D.D., McPeek, M.A., & Donoghue, M.J. (2002).
Phylogenies and community ecology.
\emph{Annual Review of Ecology and Systematics}, 33, 475–505.
\doi{10.1146/annurev.ecolsys.33.010802.150448}
}
\seealso{
\code{\link{points_to_raster}}
}
\author{
Omar Daniel Leon-Alvarado \url{https://leon-alvarado.weebly.com/}
J. Angel Soto-Centeno \url{https://www.mormoops.com/}
}
