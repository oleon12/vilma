% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/faith.pd.null.R
\name{faith.pd.null}
\alias{faith.pd.null}
\title{Null model for Faith's Phylogenetic Diversity (PD)}
\usage{
faith.pd.null(
  pd,
  tree,
  dist,
  iterations = 999,
  method = c("global", "cell"),
  sampling = c("taxa.label", "range", "neighbor", "regional"),
  n.directions = c("rook", "bishop", "queen"),
  regional.weight = c("uniform", "frequency", "range")
)
}
\arguments{
\item{pd}{An object of class \code{vilma.pd}, containing observed PD values.}

\item{tree}{A rooted phylogenetic tree of class \code{phylo}, with branch lengths.}

\item{dist}{An object of class \code{vilma.dist}, representing species distributions
(see \code{points.to.raster()}).}

\item{iterations}{Integer. Number of randomizations to perform (default = 999).}

\item{method}{Character. Null model output method:
\itemize{
\item \code{"global"} – significance of total PD across all cells.
\item \code{"cell"} – significance per cell.
}}

\item{sampling}{Character. Randomization strategy:
\itemize{
\item \code{"taxa.label"} – permutes species labels on the tree.
\item \code{"range"} – randomizes species ranges using swap algorithms.
\item \code{"neighbor"} – swaps species occurrences between adjacent cells.
}}

\item{n.directions}{Character. Neighborhood adjacency definition for the
\code{"neighbor"} method. Options: \code{"rook"}, \code{"bishop"}, \code{"queen"}
(default = \code{"queen"}).}

\item{regional.weight}{Weighting of the regional pool for the \code{"regional"} model:
\code{"uniform"} (equal), \code{"frequency"} (by number of records), or
\code{"range"} (by number of occupied cells). Defaults to \code{"uniform"}.}
}
\value{
An object of class \code{vilma.null}, with structure depending on \code{method}:
\itemize{
\item For \code{global}: a list with observed PD, null distribution, SES, p-value,
iteration table, and metadata.
\item For \code{cell}: a list with per-cell values (PD, null mean, null SD, SES, p-value),
a raster of SES values, iteration table, and metadata.
}
}
\description{
This function implements null models for Faith's PD using different
randomization approaches. It allows testing significance of PD at either
the global (across all cells) or cell level, with several sampling
strategies: randomizing taxa labels, species ranges, or neighborhood swaps.
}
\details{
The function generates a null distribution of PD values based on the chosen
sampling strategy. For the \code{"global"} method, the observed PD is compared
against the distribution of total PD values across iterations. For the
\code{"cell"} method, standardized effect sizes (SES) and p-values are computed
for each grid cell individually.
}
\examples{
\dontrun{
tree <- examplae_tree()
dist <- example_dist()
dist <- points_to_raster(dist)
pd <- faith.pd(tree, dist, method = "cell")
null_model <- faith.pd.null(pd, tree, dist,
                            iterations = 999, method = "cell",
                            sampling = "range")
}


}
\references{
Faith, D. P. (1992). Conservation evaluation and phylogenetic diversity.
\emph{Biological Conservation}, 61(1), 1–10. \doi{10.1016/0006-3207(92)91201-3}

Gotelli, N. J., & Graves, G. R. (1996). \emph{Null Models in Ecology}.
Smithsonian Institution Press.

Gotelli, N. J. (2000). Null model analysis of species co‐occurrence patterns.
\emph{Ecology}, 81(9), 2606–2621. \doi{10.1890/0012-9658(2000)081[2606:NMAOSC]2.0.CO;2}

Webb, C. O., Ackerly, D. D., McPeek, M. A., & Donoghue, M. J. (2002).
Phylogenies and community ecology. \emph{Annual Review of Ecology and Systematics},
33, 475–505. \doi{10.1146/annurev.ecolsys.33.010802.150448}
}
\seealso{
\code{\link{faith.pd}}, \code{\link{points_to_raster}},
}
\author{
Omar Daniel Leon-Alvarado \url{https://leon-alvarado.weebly.com/}
J. Angel Soto-Centeno \url{https://www.mormoops.com/}
}
